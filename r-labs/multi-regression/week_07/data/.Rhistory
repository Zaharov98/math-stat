for (i in 1:1000) {
sample.1000 <- rexp(1000, 1/mean)
sample.means.1000[i] <- mean(sample.1000)
}
var.1000 <-round(var(sample.means.1000),2)
hist(sample.means.1000, xlab=paste0("var = ", var.100))
par(op)
mean <- 15.4
op <- par(mfrow=c(2,2))
sample.100 <- rexp(100, 1/mean)
hist(sample.100)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rexp(100, 1/mean)
sample.means.100[i] <- mean(sample.100)
}
var.100 <-round(var(sample.means.100),2)
hist(sample.means.100, xlab=paste0("var = ", var.100))
sample.1000 <- rexp(100, 1/mean)
sample.means.1000 <- rep(NA, 1000)
for (i in 1:1000) {
sample.1000 <- rexp(1000, 1/mean)
sample.means.1000[i] <- mean(sample.1000)
}
var.1000 <-round(var(sample.means.1000),2)
hist(sample.means.1000, xlab=paste0("var = ", var.1000))
par(op)
mean <- 15.4
op <- par(mfrow=c(2,2))
sample.100 <- rexp(100, 1/mean)
hist(sample.100)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rexp(100, 1/mean)
sample.means.100[i] <- mean(sample.100)
}
hist(sample.means.100)
sample.1000 <- rexp(100, 1/mean)
sample.means.1000 <- rep(NA, 1000)
for (i in 1:1000) {
sample.1000 <- rexp(1000, 1/mean)
sample.means.1000[i] <- mean(sample.1000)
}
hist(sample.means.1000)
par(op)
mean <- 15.4; sd <- 2.5;
op <- par(mfrow=c(2,2))
sample.100 <- rnorm(100, mean, sd)
hist(sample.100)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rnorm(100, mean, sd)
sample.means.100[i] <- mean(sample.100)
}
hist(sample.means.100)
sample.400 <- rnorm(400, mean, sd)
sample.means.400 <- rep(NA, 1000)
for (i in 1:1000) {
sample.400 <- rnorm(400, mean, sd)
sample.means.400[i] <- mean(sample.400)
}
hist(sample.means.400)
par(op)
var(sample.means.100)
var(sample.means.400)
round(var(sample.means.100), 2)
round(var(sample.means.100), 3)
round(var(sample.means.400), 3)
sigma.100 <- round(sqrt(var(sample.means.100)), 3)
mean <- 15.4; sd <- 2.5;
op <- par(mfrow=c(2,2))
sample.100 <- rnorm(100, mean, sd)
hist(sample.100)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rnorm(100, mean, sd)
sample.means.100[i] <- mean(sample.100)
}
sigma.100 <- round(sqrt(var(sample.means.100)), 3)
hist(sample.means.100, xlab=paste0("sigma_x=", sigma.100))
sample.400 <- rnorm(400, mean, sd)
sample.means.400 <- rep(NA, 1000)
for (i in 1:1000) {
sample.400 <- rnorm(400, mean, sd)
sample.means.400[i] <- mean(sample.400)
}
hist(sample.means.400)
var(sample.means.400)
round(var(sample.means.400), 3)
par(op)
mean <- 15.4; sd <- 2.5;
op <- par(mfrow=c(2,2))
sample.100 <- rnorm(100, mean, sd)
hist(sample.100)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rnorm(100, mean, sd)
sample.means.100[i] <- mean(sample.100)
}
sigma.100 <- round(sqrt(var(sample.means.100)), 3)
hist(sample.means.100, xlab=paste0("sigma_x=", sigma.100))
sample.400 <- rnorm(400, mean, sd)
sample.means.400 <- rep(NA, 1000)
for (i in 1:1000) {
sample.400 <- rnorm(400, mean, sd)
sample.means.400[i] <- mean(sample.400)
}
sigma.400 <- round(sqrt(var(sample.means.400)), 3)
hist(sample.means.400, xlab=paste0("sigma_x=", sigma.400))
par(op)
mean <- 15.4; sd <- 2.5;
op <- par(mfrow=c(2,2))
pop <- rnorm(1000, mean, sd)
hist(pop)
sample.100 <- rnorm(100, mean, sd)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rnorm(100, mean, sd)
sample.means.100[i] <- mean(sample.100)
}
sigma.100 <- round(sqrt(var(sample.means.100)), 3)
hist(sample.means.100, xlab=paste0("sigma_x=", sigma.100))
sample.400 <- rnorm(400, mean, sd)
sample.means.400 <- rep(NA, 1000)
for (i in 1:1000) {
sample.400 <- rnorm(400, mean, sd)
sample.means.400[i] <- mean(sample.400)
}
sigma.400 <- round(sqrt(var(sample.means.400)), 3)
hist(sample.means.400, xlab=paste0("sigma_x=", sigma.400))
par(op)
mean <- 15.4; sd <- 2.5;
op <- par(mfrow=c(2,2))
pop <- rnorm(1000, mean, sd)
hist(pop, xlab=paste0("sigma=", sd))
sample.100 <- rnorm(100, mean, sd)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rnorm(100, mean, sd)
sample.means.100[i] <- mean(sample.100)
}
sigma.100 <- round(sqrt(var(sample.means.100)), 3)
hist(sample.means.100, xlab=paste0("sigma_x=", sigma.100))
sample.400 <- rnorm(400, mean, sd)
sample.means.400 <- rep(NA, 1000)
for (i in 1:1000) {
sample.400 <- rnorm(400, mean, sd)
sample.means.400[i] <- mean(sample.400)
}
sigma.400 <- round(sqrt(var(sample.means.400)), 3)
hist(sample.means.400, xlab=paste0("sigma_x=", sigma.400))
par(op)
mean <- 15.4
op <- par(mfrow=c(2,2))
sample.100 <- rexp(100, 1/mean)
hist(sample.100)
sample.means.100 <- rep(NA, 1000)
for (i in 1:1000) {
sample.100 <- rexp(100, 1/mean)
sample.means.100[i] <- mean(sample.100)
}
sigma.100 <- round(sqrt(var(sample.means.100)), 3)
hist(sample.means.100, xlab=paste0("sigma_x=", sigma.100))
sample.1000 <- rexp(100, 1/mean)
sample.means.1000 <- rep(NA, 1000)
for (i in 1:1000) {
sample.1000 <- rexp(1000, 1/mean)
sample.means.1000[i] <- mean(sample.1000)
}
sigma.1000 <- round(sqrt(var(sample.means.1000)), 3)
hist(sample.means.1000, xlab=paste0("sigma_x=", sigma.1000))
par(op)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-2, 2)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-3, 3)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6)
i.2 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-2, 2)
1 - i.2
1 - i.2$value
i3<- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-3, 3)
i.3 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-3, 3)
1 - i.3$value
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6)
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, abs.tol = 1.e-10)
.Machine$double.eps^0.25
.Machine$double.eps
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, rel.tol = .Machine$double.eps^0.5)
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, rel.tol = .Machine$double.eps)
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, rel.tol = .Machine$double.eps^0.5)
i.6$value
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, rel.tol = .Machine$double.eps^0.9)
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, rel.tol = .Machine$double.eps^0.7)
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-6, 6, rel.tol = .Machine$double.eps^0.7)
.Machine$double.eps
i.6 <- integrate(function(x) dnorm(x, mean = 0, sd = 1),
-4, 4, rel.tol = .Machine$double.eps^0.7)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-4, 4)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-5, 5)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-2, 2)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-3, 3)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-4, 4)
integrate(function(x) dnorm(x, mean = 0, sd = 1),
-5, 5)
install.packages("scatterplot3d")
library(scatterplot3d)
z <- seq(-10, 10, 0.01)
x <- cos(z)
y <- sin(z)
scatterplot3d(x, y, z, highlight.3d=TRUE, col.axis="blue",
col.grid="lightblue", main="scatterplot3d - 1", pch=20)
x <- z
y <- z
scatterplot3d(x, y, z, highlight.3d=TRUE, col.axis="blue",
col.grid="lightblue", main="scatterplot3d - 1", pch=20)
scatterplot3d(x, y, z, type="p", highlight.3d=TRUE, col.axis="blue",
col.grid="lightblue", main="scatterplot3d - 1", pch=20)
z <- seq(-10, 10, 0.01)
x <- z
y <- z
scatterplot3d(x, y, z, type="p", highlight.3d=TRUE, col.axis="blue",
col.grid="lightblue", main="scatterplot3d - 1", pch=20)
z <- seq(-10, 10, 0.01)
x <- 0.5*z
y <- 3*z
scatterplot3d(x, y, z, type="p", highlight.3d=TRUE, col.axis="blue",
col.grid="lightblue", main="scatterplot3d - 1", pch=20)
library(scatterplot3d)
z <- seq(-10, 10, 0.01)
x <- 0.5*z
y <- 3*z
scatterplot3d(x, y, z, type="p")
z <- seq(-10, 10, 0.1)
x <- 0.5*z
y <- 3*z
scatterplot3d(x, y, z, type="p")
z <- seq(-10, 10, 0.5)
x <- 0.5*z
y <- 3*z
scatterplot3d(x, y, z, type="p")
z <- seq(-10, 10, 0.5)
x <- 0.5*z
y <- 3*z
scatterplot3d(x, y, z)
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- -0.5*z
y <- 3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- 2.5*z
y <- 3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- 0.05*z
y <- 3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- 0.5*z
y <- 3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- 0.5*z
y <- 3.3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- 0.5*z + 0.3*runif(1,-1, 1)
y <- 3.3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
x <- 0.5*z + 0.8*runif(1,-1, 1)
y <- 3.3*z
scatterplot3d(x, y, z, pch=20)
n <- length(z)
z <- seq(-10, 10, 0.5)
n <- length(z)
x <- 0.5*z + 0.8*runif(n,-1, 1)
y <- 3.3*z
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
n <- length(z)
x <- 0.5*z + 0.3*runif(n, -1, 1)
y <- 3.3*z + 0.3*runif(n, -1, 1)
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
n <- length(z)
eps <- .3
x <- 0.5*z + eps*runif(n, -1, 1)
y <- 3.3*z + eps*runif(n, -1, 1)
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
n <- length(z)
eps <- .3
set.seed(1234)
x <- 0.5*z + eps*runif(n, -1, 1)
y <- 3.3*z + eps*runif(n, -1, 1)
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
n <- length(z)
eps <- .5
set.seed(1234)
x <- 0.5*z + eps*runif(n, -1, 1)
y <- 3.3*z + eps*runif(n, -1, 1)
scatterplot3d(x, y, z, pch=20)
z <- seq(-10, 10, 0.5)
n <- length(z)
eps <- .5
set.seed(1234)
x <- 0.5*z + eps*runif(n, -1, 1)
y <- 3.3*z + eps*runif(n, -1, 1)
scatterplot3d(x, y, z, pch=20)
x <- 0.5*z
y <- 3.3*z
scatterplot3d(x, y, z, type="l")
t <- scatterplot3d(x, y, z, pch=20)
t$points3d()
x <- 0.5*z
y <- 3.3*z
t$points3d(x, y, z, type="l")
z <- seq(-10, 10, 0.5)
n <- length(z)
eps <- .5
set.seed(1234)
x <- 0.5*z + eps*runif(n, -1, 1)
y <- 3.3*z + eps*runif(n, -1, 1)
t <- scatterplot3d(x, y, z, pch=20)
x <- 0.5*z
y <- 3.3*z
t$points3d(x, y, z, type="l")
library(scatterplot3d)
z <- seq(-10, 10, 0.5)
x <- 0.5*z
y <- 3.3*z
g <- scatterplot3d(x, y, z, type="l", col="red")
g <- scatterplot3d(x, y, z, type="l", col="red")
g <- scatterplot3d(x, y, z, col="red")
g <- scatterplot3d(x, y, z, type="l", color="red")
n <- length(z)
eps <- .5
set.seed(1234)
x <- x + eps*runif(n, -1, 1)
y <- y + eps*runif(n, -1, 1)
g$points3d(x, y, z, pch=20)
library(scatterplot3d)
z <- seq(-10, 10, 0.5)
x <- 0.5*z
y <- 3.3*z
g <- scatterplot3d(x, y, z, type="l", color="red")
n <- length(z)
eps <- .5
set.seed(1234)
xp <- x + eps*runif(n, -1, 1)
yp <- y + eps*runif(n, -1, 1)
g$points3d(xp, yp, z, pch=20)
set.seed(98286)
xvar <- sample(1:10, 100, replace=TRUE)
yvar <- xvar
yvar[sample(1:length(yvar), 50)] <- sample(1:10, 50, replace=TRUE)
zvar <- yvar
zvar[sample(1:length(zvar), 50)] <- sample(1:10, 50, replace=TRUE)
my.vars <- cbind(xvar, yvar, zvar)
plot(yvar~xvar, data=jitter(my.vars))
cor(my.vars)
plot(yvar~xvar, data=my.vars)
cor(my.vars)
plot(yvar~xvar, data=jitter(my.vars))
cor(my.vars)
setwd("week_07/data/")
x <- read.table("Albuquerque_Home_Prices_data.txt",
header=T, na.strings="-9999")
summary(x)
itog1 <- lm(PRICE ~ SQFT + AGE + FEATS + NE + CUST + COR + TAX, x)
summary(itog1)
itog2 <- lm(PRICE ~ SQFT + CUST + TAX, x)
summary(itog2)
babyData = read.csv('week_09/data/birthweight_reduced.csv')
head(babyData, n=3)
dim(babyData)
babyData = na.omit(babyData); dim(babyData)
class(babyData$smoker)
babyData$smoker<-factor(babyData$smoker,
labels=c('Non-smoker','Smoker'))
# Проверка на мультиколлинеарность
attach(babyData)
pairs(~Birthweight+Gestation+mheight+mppwt,
main='Birth weight scatterplots',
col=c('red','blue')[smoker], pch=c(1,4)[smoker])
round(cor(cbind(Birthweight,Gestation,mppwt,mheight)),2)
# Строим регрессионную модель на основе независимых предикторов
reg1<-lm(Birthweight~Gestation+smoker+mppwt)
summary(reg1)
babyData = read.csv('week_09/data/birthweight_reduced.csv')
babyData = read.csv('week_09/data/birthweight_reduced.csv')
getwd()
setwd("../..")
babyData = read.csv('week_09/data/birthweight_reduced.csv')
getwhead(babyData, n=3)
head(babyData, n=3)
dim(babyData)
babyData = na.omit(babyData); dim(babyData)
class(babyData$smoker)
babyData$smoker<-factor(babyData$smoker,
labels=c('Non-smoker','Smoker'))
attach(babyData)
pairs(~Birthweight+Gestation+mheight+mppwt,
main='Birth weight scatterplots',
col=c('red','blue')[smoker], pch=c(1,4)[smoker])
round(cor(cbind(Birthweight,Gestation,mppwt,mheight)),2)
reg1<-lm(Birthweight~Gestation+smoker+mppwt)
summary(reg1)
plot(reg1) # Можно потсроить все графики сразу,
xlab='Standardised residuals',ylab='Frequency')
library(car)
vif(reg1)
library(usdm)
independents<-data.frame(cbind(Gestation,smoker,mppwt))
vif(independents)
vars <- data.frame(cbind(Gestation,smoker,mheight,mppwt))
vif(vars)
vars <- data.frame(cbind(mheight,mppwt))
vif(vars)
vars <- cbind(mheight,mppwt)
vif(vars)
reg0<-lm(Birthweight~.)
vif(reg0)
attach(babyData)
View(babyData)
reg0<-lm(Birthweight~.)
reg0<-lm(Birthweight~.,babyData)
vif(reg0)
require(graphics)
fr <- function(x) {   ## Rosenbrock Banana function
x1 <- x[1]
x2 <- x[2]
100 * (x2 - x1 * x1)^2 + (1 - x1)^2
}
optim(c(-1.2,1), fr)
res <- optim(c(-1.2,1), fr, grr, method = "BFGS")
grr <- function(x) { ## Gradient of 'fr'
x1 <- x[1]
x2 <- x[2]
c(-400 * x1 * (x2 - x1 * x1) - 2 * (1 - x1),
200 *      (x2 - x1 * x1))
}
res <- optim(c(-1.2,1), fr, grr, method = "BFGS")
res1 <- optim(c(-1.2,1), fr, method = "Nelder-Mead")
reg0<-lm(Birthweight~Gestation+smoker+mheigh+mppwt)
reg0<-lm(Birthweight~Gestation+smoker+mheight+mppwt)
vif(reg0)
library(car)
vif(reg0)
vif(reg1)
babyData = read.csv('week_09/data/birthweight_reduced.csv')
head(babyData, n=3)
dim(babyData)
babyData = na.omit(babyData); dim(babyData)
class(babyData$smoker)
babyData$smoker<-factor(babyData$smoker,
labels=c('Non-smoker','Smoker'))
attach(babyData)
reg1<-lm(Birthweight~Gestation+smoker+mppwt)
summary(reg1)
library(car)
vif(reg1)
vif(lm(prestige ~ income + education, data=Duncan))
library(car)
vif(lm(prestige ~ income + education, data=Duncan))
babyData = read.csv('week_09/data/birthweight_reduced.csv')
head(babyData, n=3)
dim(babyData)
babyData = na.omit(babyData); dim(babyData)
class(babyData$smoker)
babyData$smoker<-factor(babyData$smoker,
labels=c('Non-smoker','Smoker'))
attach(babyData)
pairs(~Birthweight+Gestation+mheight+mppwt,
main='Birth weight scatterplots',
col=c('red','blue')[smoker], pch=c(1,4)[smoker])
round(cor(cbind(Birthweight,Gestation,mppwt,mheight)),2)
reg1<-lm(Birthweight~Gestation+smoker+mppwt)
summary(reg1)
vif(reg1)
reg0<-lm(Birthweight~Gestation+smoker+mheight+mppwt)
vif(reg0)
sqrt(vif(vif(reg0))) > 2 # problem?
sqrt(vif(vif(reg0))) > 2 # problem?
sqrt(vif(reg0)) > 2 # problem?
setwd("week_07/data/")
x <- read.table("Albuquerque_Home_Prices_data.txt",
header=T, na.strings="-9999")
summary(x)
itog1 <- lm(PRICE ~ SQFT + AGE + FEATS + NE + CUST + COR + TAX, x)
summary(itog1)
library(car)
vif(itog1)
